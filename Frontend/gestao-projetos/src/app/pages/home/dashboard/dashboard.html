<div class="container mt-4">
  <!-- Cabeçalho -->
  <div class="dashboard-header mb-4">
    <h1 class="dashboard-title">Dashboard</h1>
    <p class="dashboard-subtitle">Bem-vindo ao Sistema de Gestão de Projetos. Visualize estatísticas e informações importantes.</p>
  </div>

  <!-- Loading state -->
  @if (loading) {
    <div class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Carregando...</span>
      </div>
      <p class="mt-3 text-muted">Carregando dados do dashboard...</p>
    </div>
  }

  <!-- Error state -->
  @if (error && !loading) {
    <div class="alert alert-danger" role="alert">
      <span class="material-symbols-outlined me-2">error</span>
      {{ error }}
      <button
        type="button"
        class="btn btn-sm btn-outline-danger ms-2"
        (click)="recarregarDados()">
        Tentar novamente
      </button>
    </div>
  }

  <!-- Dashboard content -->
  @if (!loading) {
    <!-- Cards de Estatísticas (linha superior) -->
    <section class="stats-cards mb-4">
      <div class="row g-3">
        <!-- Card de Projetos -->
        <div class="col-md-6 col-lg-3">
          <div class="stats-card">
            <div class="card-icon">
              <span class="material-symbols-outlined">description</span>
            </div>
            <div class="card-content">
              <h3 class="metric-title">Total de Projetos</h3>
              <div class="metric-value">{{ metrics.totalProjetos }}</div>
              <p class="metric-detail">{{ metrics.projetosAvaliados }} avaliados, {{ metrics.projetosPendentes }} pendentes</p>
            </div>
          </div>
        </div>

        <!-- Card de Avaliações -->
        <div class="col-md-6 col-lg-3">
          <div class="stats-card">
            <div class="card-icon">
              <span class="material-symbols-outlined">task_alt</span>
            </div>
            <div class="card-content">
              <h3 class="metric-title">Avaliações</h3>
              <div class="metric-value">{{ metrics.totalAvaliacoes }}</div>
              <p class="metric-detail">{{ metrics.avaliacoesPendentes }} avaliações pendentes</p>
            </div>
          </div>
        </div>

        <!-- Card de Pessoas -->
        <div class="col-md-6 col-lg-3">
          <div class="stats-card">
            <div class="card-icon">
              <span class="material-symbols-outlined">people</span>
            </div>
            <div class="card-content">
              <h3 class="metric-title">Pessoas</h3>
              <div class="metric-value">{{ metrics.totalPessoas }}</div>
              <p class="metric-detail">Autores e avaliadores cadastrados</p>
            </div>
          </div>
        </div>

        <!-- Card de Prazos -->
        <div class="col-md-6 col-lg-3">
          <div class="stats-card">
            <div class="card-icon">
              <span class="material-symbols-outlined">schedule</span>
            </div>
            <div class="card-content">
              <h3 class="metric-title">Próximo Prazo</h3>
              <div class="metric-value">30/06/2025</div>
              <p class="metric-detail">Fim do período de submissão</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Abas de Navegação -->
    <nav class="tab-navigation mb-4">
      <div class="nav-tabs-custom">
        <button
          class="nav-tab"
          [ngClass]="{'active': selectedTab === 'projetos'}"
          (click)="setTab('projetos')">
          Projetos Recentes
        </button>
        <button
          class="nav-tab"
          [ngClass]="{'active': selectedTab === 'avaliacoes'}"
          (click)="setTab('avaliacoes')">
          Avaliações Pendentes
        </button>
        <button
          class="nav-tab"
          [ngClass]="{'active': selectedTab === 'cronograma'}"
          (click)="setTab('cronograma')">
          Cronograma
        </button>
      </div>
    </nav>

    <!-- Seção - Conteúdo da Aba Ativa -->
    <section class="tab-content-section">
      <!-- Aba Projetos Recentes -->
      @if (selectedTab === 'projetos') {
        <div class="section-header mb-4">
          <h2 class="section-title">Projetos Recentes</h2>
          <button class="btn-new-project" routerLink="/home/projetos">
            <span class="material-symbols-outlined">add</span>
            Novo Projeto
          </button>
        </div>

        <!-- Cards de Projetos -->
        <div class="projects-grid">
          @if (projetosRecentes.length > 0) {
            @for (projeto of projetosRecentes; track projeto.id) {
              <div class="project-card">
                <div class="project-header">
                  <h4 class="project-title">{{ projeto.titulo }}</h4>
                  <span class="project-status" [ngClass]="getProjetoStatusClass(projeto)">
                    {{ getProjetoStatus(projeto) }}
                  </span>
                </div>
                <p class="project-date">Enviado em {{ formatDate(projeto.dataEnvio) }}</p>
                <p class="project-description">{{ projeto.areaTematica }}</p>
                <p class="project-authors">{{ formatAuthors(projeto.autores) }}</p>
                <button class="btn-details">Ver detalhes</button>
              </div>
            }
          } @else {
            <div class="empty-state">
              <span class="material-symbols-outlined">folder_open</span>
              <p>Nenhum projeto encontrado.</p>
            </div>
          }
        </div>
      }

      <!-- Aba Avaliações Pendentes -->
      @if (selectedTab === 'avaliacoes') {
        <div class="section-header mb-4">
          <h2 class="section-title">Avaliações Pendentes</h2>
          <button class="btn-new-project" routerLink="/home/avaliacoes">
            <span class="material-symbols-outlined">visibility</span>
            Ver Todas
          </button>
        </div>

        <div class="evaluations-list">
          @if (avaliacoesPendentes.length > 0) {
            @for (avaliacao of avaliacoesPendentes; track avaliacao.id) {
              <div class="evaluation-item">
                <div class="evaluation-content">
                  <h4 class="evaluation-title">{{ avaliacao.projeto.titulo }}</h4>
                  <p class="evaluation-area">{{ avaliacao.projeto.areaTematica }}</p>
                  <p class="evaluation-evaluator">Avaliador: {{ avaliacao.avaliador.nome }}</p>
                </div>
                <span class="evaluation-status">{{ avaliacao.status.description }}</span>
              </div>
            }
          } @else {
            <div class="empty-state">
              <span class="material-symbols-outlined">check_circle</span>
              <p>Nenhuma avaliação pendente.</p>
            </div>
          }
        </div>
      }

      <!-- Aba Cronograma -->
      @if (selectedTab === 'cronograma') {
        <div class="section-header mb-4">
          <h2 class="section-title">Cronograma</h2>
          <button class="btn-new-project" routerLink="/home/cronogramas">
            <span class="material-symbols-outlined">calendar_month</span>
            Ver Cronograma
          </button>
        </div>

        <div class="timeline-preview">
          <div class="timeline-item">
            <div class="timeline-date">15 Set 2025</div>
            <div class="timeline-content">
              <h4>Início das Submissões</h4>
              <p>Período de envio de projetos aberto</p>
            </div>
          </div>
          <div class="timeline-item">
            <div class="timeline-date">30 Jun 2025</div>
            <div class="timeline-content">
              <h4>Fim das Submissões</h4>
              <p>Último dia para envio de projetos</p>
            </div>
          </div>
          <div class="timeline-item">
            <div class="timeline-date">15 Jul 2025</div>
            <div class="timeline-content">
              <h4>Avaliações</h4>
              <p>Período de avaliação dos projetos</p>
            </div>
          </div>
        </div>
      }
    </section>
  }
</div>
