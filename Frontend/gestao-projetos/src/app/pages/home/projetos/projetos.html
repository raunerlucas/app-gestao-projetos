<div class="container mt-4">
  <!-- Cabeçalho da Página -->
  <div class="mb-4">
    <h1 class="page-title">Projetos</h1>
    <p class="page-description">Gerencie seus projetos, visualize avaliações e submeta novos trabalhos.</p>
  </div>

  <!-- Barra de Ações -->
  <div class="actions-bar mb-4">
    <div class="d-flex justify-content-between align-items-center">
      <div class="d-flex gap-3 flex-grow-1">
        <!-- Input de busca -->
        <div class="search-container">
          <div class="position-relative">
            <span class="material-symbols-outlined search-icon">search</span>
            <input
              type="text"
              class="form-control search-input"
              placeholder="Buscar projetos..."
              [(ngModel)]="searchTerm"
              (input)="onSearch()">
          </div>
        </div>

        <!-- Filtro por status -->
        <div class="filter-container">
          <select
            class="form-select status-filter"
            [(ngModel)]="statusFilter"
            (change)="onStatusFilterChange()">
            @for (option of statusOptions; track option.value) {
              <option [value]="option.value">{{ option.label }}</option>
            }
          </select>
        </div>
      </div>

      <!-- Botão Novo Projeto -->
      <button
        class="btn btn-new-project"
        (click)="toggleModalNovoProjeto()">
        <span class="material-symbols-outlined me-2">add</span>
        Novo Projeto
      </button>
    </div>
  </div>

  <!-- Tabela de Projetos -->
  <div class="card projects-card">
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table projects-table mb-0">
          <thead>
            <tr>
              <th>Título</th>
              <th>Área Temática</th>
              <th>Data de Envio</th>
              <th>Autores</th>
              <th>Status</th>
              <th class="text-end">Ações</th>
            </tr>
          </thead>
          <tbody>
            @if (filteredProjetos.length > 0) {
              @for (projeto of filteredProjetos; track projeto.id) {
                <tr class="project-row">
                  <td class="project-title">{{ projeto.titulo }}</td>
                  <td class="project-area">{{ projeto.areaTematica }}</td>
                  <td class="project-date">{{ formatDate(projeto.dataEnvio) }}</td>
                  <td class="project-authors">{{ formatAuthors(projeto.autores) }}</td>
                  <td class="project-status">
                    <span [ngClass]="getStatusBadgeClass(projeto.status)">
                      {{ getStatusDisplay(projeto) }}
                    </span>
                  </td>
                  <td class="project-actions text-end">
                    <app-float-menu [config]="getFloatMenuConfig(projeto)"></app-float-menu>
                  </td>
                </tr>
              }
            } @else {
              <tr>
                <td colspan="6" class="text-center py-5 empty-state">
                  <span class="material-symbols-outlined d-block mb-2 text-muted empty-icon">
                    folder_open
                  </span>
                  <span class="text-muted">
                    @if (searchTerm || statusFilter !== 'TODOS') {
                      Nenhum projeto encontrado com os filtros aplicados.
                    } @else {
                      Nenhum projeto encontrado.
                    }
                  </span>
                  @if (searchTerm || statusFilter !== 'TODOS') {
                    <div class="mt-2">
                      <button
                        class="btn btn-sm btn-outline-secondary"
                        (click)="searchTerm = ''; statusFilter = 'TODOS'; applyFilters()">
                        Limpar filtros
                      </button>
                    </div>
                  }
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Modal Novo Projeto -->
@if (showModalNovoProjeto) {
  <div class="modal-backdrop fade show" (click)="toggleModalNovoProjeto()"></div>
  <div class="modal fade show d-block" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title fw-bold">Novo Projeto</h5>
          <button type="button" class="btn-close" (click)="toggleModalNovoProjeto()"></button>
        </div>
        <div class="modal-body">
          <div class="text-center py-4">
            <span class="material-symbols-outlined d-block mb-2 text-primary" style="font-size: 3rem;">
              add_circle
            </span>
            <h6 class="fw-bold">Funcionalidade em Desenvolvimento</h6>
            <p class="text-muted">O cadastro de novos projetos estará disponível em breve.</p>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="toggleModalNovoProjeto()">
            Fechar
          </button>
        </div>
      </div>
    </div>
  </div>
}
